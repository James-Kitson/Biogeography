---
title: "Statistical Analyses for Kitson *et al.* 2016"
author: '**James Kitson**'
header-includes:
   - \usepackage[final]{pdfpages}
output: 
    pdf_document:
      latex_engine: xelatex
toc: true
urlcolor: blue
---

```{r setup, include=FALSE}
require(knitr)
knitr::opts_chunk$set(echo = FALSE,
                      warning=FALSE,
                      message=FALSE,
                      dev = 'pdf',
                      fig.align='center')
```

#Outline
The purpose of this Rmarkdown document is to allow users to follow our statistical analyses for both the plotting of biogeogpahic analysis results and the subsequent statistics performed on node ages. Analyses are performed using separate R scripts called by this document and users should refer to the unrendered [Notebook.Rmd](https://github.com/James-Kitson/Biogeography/blob/master/Notebook.Rmd) file for links to the relevant scripts.

\newpage

\eject \pdfpagewidth=20in \pdfpageheight=100in

#This is going to be a big page with a tree of all my COII samples

\newpage

\eject \pdfpagewidth=210mm \pdfpageheight=297mm

```{r echo=FALSE}
read_chunk('R_scripts/RASPBBM_node_age_stats.R')
```
```{r}
<<processdata1>>
```
#Statistical analysis of node ages
For each of the statistical analyses outlined in the main manuscript we have taken a bootstrapping approach that allows us to compare the mean age of our nodes of interest (*i.e.* flight loss nodes, *in situ* speciation nodes, comparison of nodes across islands) to an equally sized subset of the remaining nodes in each analysis resampled `r iter` times.

#Statistics from the Bayesian Binary Markov analysis in RASP.
##RASP BBM
```{r echo=FALSE}
read_chunk('R_scripts/BBM_biogeography.R')
```
```{r fig.width=7, fig.height=10, message=F, warning=F}
<<BBMtreeprocess>>
<<BBMtreeplot>>
```
\newpage

##Comparing the age of flight loss nodes to nodes without flight loss

```{r echo=FALSE}
read_chunk('R_scripts/RASPBBM_node_age_stats.R')
```
```{r}
<<processdata1>>
```
```{r}
<<BBMflightloss>>
<<BBMflightlossttest>>
```
\newpage
```{r}
<<processdata2>>
```
##Comparing the average node age on Reunion to Mauritius
```{r}
<<BBMMauvsReu>>
<<BBMMauvsReuttest>>
```
\newpage
```{r}
<<processdata3>>
```
##Comparing the age of *in situ* speciation events on Reunion to colonisation events
```{r}
<<BBMinsituReu>>
<<BBMinsituReuttest>>
```
\newpage
```{r}
<<processdata4>>
```
##Comparing the age of colonisation events on Mauritius to *in situ* speciation events
This is reversed relative to the test performed on Reunion nodes as there are many more *in situ* speciation nodes on Mauritius than colonisations.

```{r}
<<BBMinsituMau>>
<<BBMinsituMauttest>>
```
\newpage
#Statistics from the Maximum Likelihood analyses in R.
##R Maximum Likelihood
```{r echo=FALSE}
read_chunk('R_scripts/ML_biogeography.R')
```
```{r fig.width=7, fig.height=10, message=F, warning=F}
<<MLtreeprocess>>
<<MLtreeplot>>
```
\newpage

```{r echo=FALSE}
read_chunk('R_scripts/RML_node_age_stats.R')
```
```{r}
<<processdata5>>
```
##Comparing the age of flight loss nodes to nodes without flight loss
```{r}
<<RMLflightloss>>
<<RMLflightlossttest>>
```
\newpage  
```{r}
<<processdata6>>
```
##Comparing the average node age on Reunion to Mauritius
```{r}
<<RMLMauvsReu>>
<<RMLMauvsReuttest>>
```
\newpage
```{r}
<<processdata7>>
```
##Comparing the age of *in situ* speciation events on Reunion to colonisation events
```{r}
<<RMLinsituReu>>
<<RMLinsituReuttest>>
```
\newpage
```{r}
<<processdata8>>
```
##Comparing the age of colonisation events on Mauritius to *in situ* speciation events
This is reversed relative to the test performed on Reunion nodes as there are many more *in situ* speciation nodes on Mauritius than colonisations.
```{r}
<<RMLinsituMau>>
<<RMLinsituMauttest>>